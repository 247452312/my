<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="indi.uhyils.dao.UserDao">


    <sql id="columnList">
        id,
        `name`,
        class_id as classId,
        create_date as 'createDate',
        update_date as 'updateDate',
        del_mark as 'delMark',
        remark
    </sql>

    <select id="getByArgs" resultType="indi.uhyils.model.UserEntity">
        select
        <include refid="columnList"/>
        from user
        where del_mark = 0
        <foreach item="item" index="index" collection="list">
            and ${item.name} ${item.symbol} #{item.data}
        </foreach>
        <if test="page != null and page != ''">
            limit ${(page-1) * size},${page * size}
        </if>
    </select>


    <select id="getByArgsNoPage" resultType="indi.uhyils.model.UserEntity">
        select
        <include refid="columnList"/>
        from user
        where del_mark = 0
        <foreach item="item" index="index" collection="list">
            and ${item.name} ${item.symbol} #{item.data}
        </foreach>


    </select>


    <select id="getById" resultType="indi.uhyils.model.UserEntity">
        select
        <include refid="columnList"/>
        from user
        where del_mark = 0
        and id = #{id}
    </select>
    <select id="getByClassId" resultType="indi.uhyils.model.UserEntity">
        select
        <include refid="columnList"/>
        from user
        where del_mark = 0
        and class_id = #{classId}
    </select>

    <insert id="insert" parameterType="indi.uhyils.model.UserEntity">
        insert user(
        <include refid="columnList"/>
        )
        values(#{id},#{name},#{classId},#{create_date},#{update_date},0,#{remark})
    </insert>
    <update id="update" parameterType="indi.uhyils.model.UserEntity">
        update class set `name`=#{name},class_id = #{classId},create_date=#{createDate},update_date=#{updateDate},del_mark=#{delMark},remark=#{remark} where id = #{id}
    </update>

</mapper>